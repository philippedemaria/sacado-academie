{% extends 'dashboard.html' %}
{% load static %}
{% load widget_tweaks %}
{% load item_tags %}
 
 
{% block page_title %}
    <i class="bi bi-calendar-week"></i> Prép' Éval {{ prepeval.date }}
{% endblock %}


{% block require %}

    <script src="{% static 'js/require.js' %}"   data-main="{% static 'js/common3_withoutMathJax.js' %}"></script>
    <script>
        require(['script/ajax-prep_eval']);
    </script> 
{% endblock %} 



{% block page_menu_right %}
{% endblock %}

 




{% block body  %}  


<section class="content_main">
    <div class="row">
        <div class="col-xs-12">
            <div style="float:right">
                {% for slot in slots %}
                <a href="#" class="prep_day {% if slot.date == today %}prep_day_today{% endif %}" data-toggle="tab" data-panel="{{ forloop.counter }}">
                    <div class="prep_month"><b>J - {{ forloop.revcounter}}</b></div>
                    {{ slot.date|date:"d"}}
                    <div class="prep_month">{{ slot.date|date:"N"}}</div>
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    {% for slot in slots %}   
    <div id="panel{{forloop.counter}}" class="panels {% if slot.date == today %}this_panel{% else %}no_visu_on_load{% endif %}"> 
        <div class="row">
            <div class="col-xs-8">  
                <h2 class="text-mauve">{{ slot.content|safe }} {{ slot.date|date:"d N Y" }} </h2>
                {% for r in slot.relationships.all %}
                    
                        {% if r.type_id == 0 %}
                        <a href="{% url 'execute_exercise' r.parcours.id r.exercise.id %}" class="prep_listing">
                            {% if  r.exercise.supportfile.imagefile %}
                            <img src="{{ r.exercise.supportfile.imagefile.url }}"  class="prep_image" />
                            {% endif %}
                            <b>Exercice.</b> {{ r.duration}} min. 
                            {% if r.supportfile.calculator %}
                                <img src="{% static 'img/calculator.png' %}"  with="20px"  height="20px" />
                            {% else %}
                                <img src="{% static 'img/no_calculator.png' %}"  with="20px"  height="20px"  />
                            {% endif  %} 
                            <br/>
                            {{ r.exercise.knowledge.name }}<br/>

                            {% get_score_and_time  r.exercise student as st_list %}
                            {% for st in st_list %} 
                                <div  class="markdown
                                {% if st.score < 30 %}
                                 red 
                                {% elif st.score < 60 %}
                                orange
                                {% elif st.score < 80 %}
                                green
                                {% else %}
                                darkgreen
                                {% endif %}" style="font-size:10px">{{ st.score }}% 
                                </div>  
                            {% endfor %}
                        </a>
                        {% elif r.type_id == 2 %}
                        <a href="{% url 'show_course_sequence_student' r.type_of_document.id  r.parcours.id %}" class="prep_listing">
                            <img src="{% static 'img/logo_cours.jpg' %}" class="prep_image" /><b>{{ r.type_of_document.forme }}</b><br/>
                            {{ r.duration}} min. 
                        </a>
                        {% elif r.type_id == 3 %}
                        <a href="{% url 'goto_quizz_student' r.type_of_document.id %}" class="prep_listing">
                            <img src="{% static 'img/logo_quizz.jpg' %}" class="prep_image" /> <b>Quizz</b> <br/>
                            {{ r.duration}} min. <br/> {{r.type_of_document.questions.count }} questions
                        </a>
                        {% elif r.type_id == 4 %}
                        <a href="{% url 'show_bibliotex' r.type_of_document.id %}" class="prep_listing">
                            <img src="{% static 'img/logo_bibliotex.jpg' %}" class="prep_image" /> <b>Sujet rédigé</b><br/>
                            {{ r.duration}} min. 
                        </a>
                        {% elif r.type_id == 5 %}
                        <a href="{% url 'show_flashpack' r.type_of_document.id %}" class="prep_listing">
                            <img src="{% static 'img/logo_flashcard.jpg' %}" class="prep_image" /> <b>Cartes mémoire</b><br/>
                            {{ r.duration}} min. {{r.type_of_document.flashcards.count }} questions
                        </a>
                        {% endif %}<br/>
                {% endfor %}
            </div>
            <div class="col-xs-12 col-md-4">
                <div class="bilan_prep">
                    <h2 class="text-mauve">{{ slot.content|safe }} {{ slot.date|date:"d N Y" }} </h2>
                    <div class="bilan_prep_round" align="center">Exercices faits<div class="prep_round">{{ slot.dataset.nb_ans }}</div></div>
                    <div class="bilan_prep_round" align="center">Exercices non faits<div class="prep_round">{{ slot.dataset.nbr_no }}</div></div>
                    <div class="bilan_prep_round" align="center">Score moyen<div class="prep_round" style="border-color:{{ slot.dataset.color }}">{{ slot.dataset.percent }}</div></div>

                    {% if slot.dataset.is_end %}
                    <div class="prep_comment_title">Commentaire :</div>
                    <div class="prep_comment">{{ slot.dataset.comment }}</div>
                    {% else %}
                    <div class="prep_comment_title"></div>
                    {% endif %}
                </div>
            </div>        
        </div>  
    </div>             
    {% endfor %}
    <div class="row">
        <div class="col-xs-12">
            <a href="{% url 'prep_eval' student.user.id %}" class="btn btn-lg btn-sacado">Retour</a>
        </div>
    </div>
</section>
{% endblock %} 


 






 
