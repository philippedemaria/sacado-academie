{% extends 'base.html' %}
{% load widget_tweaks %}
{% load static %}
{% load item_tags %}
 


{% block body %}
    <section class="container"> 
        <form action="" method="POST" enctype='multipart/form-data'>
            {% csrf_token %}             {{ userFormset.management_form }}
            <div class="row">
                {% for form in userFormset %}
                <div class="col-sm-12 col-md-6" style="margin-top:30px">
                    <div class="card" style="padding:30px;margin-bottom: 20px;background-color: #f1eef7">
                        <h4  class="title_page violet">
                            
                            {% if forloop.first %}Responsable légal{% else %}Enfant 
                            {% endif %}
 
                        </h4>
                        <div class="form-group">
                            {{ form.last_name.label_tag }}
                            {{ form.last_name |add_class:"form-control id_last_name"|attr:"required" }}
                            {{ form.last_name.errors }}
                        </div>     
                        <div class="form-group">
                            {{ form.first_name.label_tag }}
                            {{ form.first_name |add_class:"form-control id_first_name"|attr:"required" }}
                            {{ form.first_name.errors }}
                        </div>
                        <div class="form-group">
                            {% if forloop.first %}
                                {{ form.email.label_tag }} 
                                {{ form.email |add_class:"form-control email"|attr:"required" }}
                            {% else  %}
                                {{ form.email.label_tag }} <em>facultatif </em>
                                {{ form.email |add_class:"form-control email"}}
                            {% endif %}
                            {{ form.email.errors }}
                        </div>
                        <div class="row"> 
                            <div class="col-sm-12 col-md-11">
                                <div class="form-group">
                                    <label>Choisir un identifiant :</label>
                                    {{ form.username |add_class:"form-control username"|attr:"required" }}
                                    <span style="font-size:12px">L'identifiant et le mot de passe ne doivent pas contenir une même séquence de lettres.</span><span id="ajaxresult{{ forloop.counter0 }}" class="ajaxresult"></span>
                                    {{ form.username.errors }}
                                </div>
                            </div> 
                        </div>       
                        <div class="row">
                            <div class="col-sm-12 col-md-6">
                                <div class="form-group">
                                    {{ form.password1.label_tag }} <b><em>Au moins 8 caractères</em></b>
                                    {{ form.password1 |add_class:"form-control"|attr:"required" }}
                                    {{ form.password1.errors }}
                                </div>
                            </div>  
                            <div class="col-sm-12 col-md-6">
                                <div class="form-group">
                                    {{ form.password2.label_tag }}
                                    {{ form.password2 |add_class:"form-control"|attr:"required" }}
                                    {{ form.password2.errors }}
                                </div>
                            </div>
                        </div> 
                        {% if not forloop.first %}
                        <div class="form-group">
                            <label>Niveau :</label>
                            <select name="level" class="form-control select2" required>
                                <option value="idl">{{ level.name }}</option>
                            </select>
                        </div>
                            {% if formule.id == 1 %}
                            <div class="form-group">
                                <label>Durée :</label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="1" /> 1 mois à 5€</label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="3" /> 3 mois à 14€, soit 6 jours gratuits</label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="6" /> 6 mois à 26€, soit 24 jours gratuits</label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="12" /> 12 mois à 50€, soit 60 jours gratuits</label>
                            </div>
                            {% elif formule.id == 2 %}
                            <div class="form-group">
                                <label>Durée :</label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="1" /> 1 mois </label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="3" /> 3 mois </label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="6" /> 6 mois </label><br/>
                                <label><input type="radio" name="duration{{ forloop.counter0}}" value="12" /> 12 mois </label>
                            </div>
                            {% endif %}
                        {% else %}
                            <input name="level" value="" type="hidden" />
                        {% endif %}

                        {% if forloop.counter == 1 %}
                        <div class="row">
                            <div class="col-sm-12 col-md-12">
                                <div class="form-group">
                                    <label>{{ form.cgu|attr:"required" }}   Je reconnais avoir lu et compris les <a href="#" data-target="#cgu" data-toggle='modal'>conditions générales d'utilisation</a> et je les accepte.</label>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>








            <div class="row">
                <div class="col-sm-12 col-md-12">   

                    <button type="submit" class="btn btn-primary" >Acheter le cahier vacances {{ group.level.shortname_full|safe  }}, passeport pour l'entrée en {{  hbook.level_next }}</button>

                    <a href="javascript:history.back()"  class="btn btn-default " >Retour </a>
        
                </div>
            </div>
        </form>
    </section>
{% endblock %}