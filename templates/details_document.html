{% load static %}
{% load item_tags %}
{% load widget_tweaks %}


{% if rc.type_id == 0 %}
<div class="card_freeze" style="{% if not rc.is_publish %}background-color: #F5F5F5{% else %}background:#FFF{% endif %}" id="card{{rc.id}}">
    <!-- Entete de la card  -->
    <div class="card-body" style="height:37px;">
          <input type="hidden" value="{{ rc.exercise.id }}" name="input_exercise_id" class="div_exercise_id" data-custom=0 /><!--  sert à classer les thèmes  -->
          <input type="hidden" value="{{ rc.id }}" name="relationship_id_sequence" class="relationship_id_sequence" /><!--  sert à classer les thèmes  -->
          <a href="" style="cursor:move;" class="move_inside" style="color:{{ parcours.color }}"> 
          {% if not rc.is_publish %}<span style="color:#F5F5F5">{{ nb_exo_only|index:forloop.counter0 }}.</span>{% else %}{{ nb_exo_visible|index:forloop.counter0 }}.{% endif %}
          </a>
                       
          <div class="card-score">
              {%  get_percent_student_done_parcours_exercice_group   rc   parcours group  as    data %}
 
 
              <div class="progress">
                <div class="progress-bar bg-success" role="progressbar" style="width: {{ data.percent }}%;{% if not rc.is_publish %}color: #F5F5F5{% endif %};background-color: {{rc.parcours.color }};" aria-valuenow="{{ data.percent }}" aria-valuemin="0" aria-valuemax="100">{{ data.percent }}%</div>
              </div>
          </div>
          <span class="label_progress_bar" style="color:{{rc.parcours.color }}">{{ data.nb_done }}/{{ data.nb }}</span> 
          {% if rc.exercise.supportfile.calculator %}
            <img src="{% static 'img/calculator.png' %}" class="pull-right" width="35px" loading="lazy" />
          {% else %}
            <img src="{% static 'img/no_calculator.png' %}" class="pull-right" width="35px" loading="lazy" />
          {% endif  %}
    </div>   
    <!-- Fin Entete de la card  -->

    <!-- Partie sur laquelle est posée l'image  -->                  
    <div class="card-image">
          {% if rc.is_lock  %}
                  <div class="alert alert-danger" style="position: absolute; z-index:9; top:100px;font-size:12px;border-radius: 0px 4px 4px  0px;"> 
                      <i class="fa fa-lock"></i> <span class="hidden_lock"></span>
                  </div>
          {% endif %}
          


        {% if not rc.exercise.supportfile.is_ggbfile %}
          <div style="position: absolute; left : 30px; top:41px;" id="annoncement{{rc.id}}">   
              <span class="helper_tip btn btn-default">Consigne
                <div class="helper_tip_text_right"> {% if rc.instruction %}    {{rc.instruction|safe|truncatechars_html:45}}    {% else %}      {{ rc.exercise.supportfile.annoncement|safe }}  {% endif %}</div> 
              </span>
          </div>
        {% endif %}
 
        {% if group %}
          {% get_students_from_group_and_rc rc group as data_rc %}
          {% get_only_students  parcours group as  only_real_student %}
          <!-- Exercice dissocié  -->  
          <div  style="position: absolute; left : 0px; top:80px;" title="Cet exercice est indiviualisé à certains élèves. Cliquez sur l'icone dans la barre d'outil pour modifier." id="individialise_id_student{{  rc.exercise.id }}"  {% if  data_rc.nb == only_real_student.count  %} class="checkbox_no_display" {% endif %}>   
            <span class="btn btn-warning" style="cursor:auto">
              <i class="fa fa-users"></i><span id="nb_indiv_id_student{{  rc.exercise.id }}"> {{ data_rc.nb }} </span>  
            </span>
 
          </div>

        {% endif %}

          <!-- Publication  -->
          <div href="#card{{rc.id}}" class="action_content {% if  rc.is_publish %}btn btn-success{% else %}btn btn-danger{% endif %}"  style="position: absolute; right : 0px; top:90px;" id="publisher{{rc.id}}"  data-relationship_id="{{rc.id}}" data-statut="{{rc.is_publish }}" data-custom="0" title="Publier l'exercice" >   
              {% if  rc.is_publish %}Publié{% elif rc.start %}{{ rc.start|date:"d N Y" }}{% else %}Dépublié{% endif %}
          </div>

          <!-- Tache  -->
          <div href="#card{{rc.id}}" class="btn btn-{% if  rc.date_limit %}success{% else %}default{% endif %} select_task"  style="position: absolute; right : 0px; top:120px;" id="pub_task{{rc.id}}" data-relationship_id="{{rc.id}}" data-statut="{{rc.is_task }}"  title="Proposer une tâche pour le" data-custom="0"  >   
              <span id="loading{{ rc.id }}"></span>{% if  rc.date_limit %}{{rc.date_limit|date:"d N Y" }}{% else %}Tâche ?{% endif %}
          </div>

          <!-- Constraint  -->
          <div class="btn btn-{% if  rc.relationship_constraint.all|length > 0 %}danger{% else %}default{% endif %} select_constraint"  
                style="position: absolute; right : 0px; top:150px;" 
                id="constraint{{rc.id}}"  title="Ajouter une contrainte pour afficher l'exercice" 
                data-relationship_id="{{rc.id}}">   
              <i class="fa fa-minus-circle"></i>
          </div>

          <!--  
          =============================================================================================================
          =============================================================================================================
                Pop up de la date de la tache d'un exercice  
          =============================================================================================================
          =============================================================================================================-->
          <!-- Pop up de la date de la tache d'un exercice  -->
          <div id="detail_dateur{{rc.id}}" class="card-dateur no_visu_on_load"  > 
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">     
                        <span href="#card{{rc.id}}" class="select_task_close pull-right" data-relationship_id="{{rc.id}}"><i class="fa fa-times"></i></span>  
                         Programmation de tâche  
                    </div>
               </div> 
              <hr style="padding:0px; margin:10px 0px"/> 
                <label  style="font-size: 10px;">Date limite de rendu ?</label><br>
                <input type="type" name="dateur" data-relationship_id="{{rc.id}}" data-type ="1" data-custom ="0" value='{{ rc.date_limit|date:"Y-m-d" }}' class="datetimepicker dateur pull-right" />
          </div>

          <!-- Pop up de la date de publication d'un exercice  -->
          <div id="detail_pub{{rc.id}}" class="card-dateur no_visu_on_load"  >
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">     
                        <span href="#card{{rc.id}}" class="select_publish_close pull-right" data-relationship_id="{{rc.id}}"><i class="fa fa-times"></i></span>  
                         Date de publication
                    </div>
               </div> 
              <hr style="padding:0px; margin:10px 0px"/>             
                <label  style="font-size: 12px;">Date de publication ?</label><br>
                <input type="type" name="start" data-relationship_id="{{rc.id}}" data-type ="0" data-custom ="0" value='{{ rc.date_limit|date:"Y-m-d" }}' class="datetimepicker dateur pull-right" />
          </div>
          <!--  
          =============================================================================================================
          =============================================================================================================
                Pop up de la constrainte 
          =============================================================================================================
          =============================================================================================================-->
          <div id="detail_constraint{{rc.id}}" class="card-dateur no_visu_on_load"> 
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">  
                      <span href="#card{{rc.id}}" class="select_constraint_close pull-right" data-relationship_id="{{rc.id}}"><i class="fa fa-times"></i></span>  
                       Contraintes 
                    </div>
               </div> 
              <hr style="padding:0px; margin:10px 0px"/>

               <div class="row">
                    <div class="col-sm-12 col-md-12">               
                        <span class="explain">  Pour accéder à cet exercice, il faut réaliser le score minimum à l'exercice associé ou à tous les précédents.</span>  
                    </div>
               </div> 

               <div class="row">
                    <div class="col-sm-6 col-md-4">
                        <label  style="font-size: 10px;">Code Exo</label> <span id="is_exist{{rc.id}}" class="text-danger"></span><br>
                        <input type="type"  
                                id="codeExo{{rc.id}}"  
                                data-relationship_id="{{rc.id}}"  
                                data-custom=0 
                                maxlength="8"  
                                style="width:80px" 
                                placeholder="bm4p8r31" 
                                class="codeExo details_relation"  /> 
                    </div>
                    <div class="col-sm-6 col-md-1">
                        <label  style="font-size: 10px;">Tous</label><br>
                        <input type="checkbox"  id="all_of_them{{rc.id}}" data-relationship_id="{{rc.id}}" class="all_of_them" /> 
                    </div>
                    <div class="col-sm-6 col-md-4">
                        <label  style="font-size: 10px;">Score min.</label><br>
                        <input type="number"  id="scoreMin{{rc.id}}"  maxlength="3"  size="3" value="80" data-custom="0"  class="details_relation" />%
                    </div>
                    <div class="col-sm-6 col-md-2">
                        <a href="#" data-parcours_id="{{rc.parcours.id}}"  data-relationship_id="{{rc.id}}" id="save_constraint{{rc.id}}" class="save_constraint btn btn-danger">OK</a>
                    </div>

                </div> 
                <hr style="padding:0px; margin:10px 0px"/> 
                <div id="new_constraint{{rc.id}}" class="text-danger">
                {% if rc.relationship_constraint.all|length == forloop.counter0 %} 
                  <div id="constraint_saving0">
                      <span class="text-red"  style="font-size: 11px;"><i class="fa fa-minus-circle"></i> Tous les exercices précédents</span>
                      <a href="#"  onclick="return TestDelete('cette constrainte ')"  
                          class="pull-right delete_constraint" 
                          data-constraint_id="0" 
                          data-relationship_id="{{rc.id}}"
                          data-is_all=1 >
                          <i class="fa fa-trash"></i> 
                      </a>
                    </div>
                {% else %}   
                  {% for constraint in rc.relationship_constraint.all %}
                      <div  id="constraint_saving{{constraint.id}}">
                        <span class="text-red"  style="font-size: 11px;"><i class="fa fa-minus-circle"></i> {{ constraint }}</span>
                        <a href="#" onclick="return TestDelete('cette constrainte ')" 
                                    class="pull-right delete_constraint"  
                                    data-constraint_id="{{constraint.id}}" 
                                    data-relationship_id="{{rc.id}}"
                                    data-is_all=0  >
                            <i class="fa fa-trash"></i> 
                        </a>
                      </div>
                      {% if not forloop.last %}<br>{% endif %}
                  {% empty %}
                        Aucune constrainte appliquée
                  {% endfor %}
                {% endif %}   
               </div>
          </div>

           <!--  
          =============================================================================================================
          =============================================================================================================
                Pop up de la durée et du nombre de situation d'un exercice
          =============================================================================================================
          =============================================================================================================-->
          <div id="details{{rc.id}}" class="card-dateur no_visu_on_load"  > 
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">
                    <span href="#card{{rc.id}}" class="select_details_close pull-right" data-relationship_id="{{rc.id}}"><i class="fa fa-times"></i></span>               
                        Contexte 
                    </div>
               </div> 
              <hr style="padding:0px; margin:10px 0px"/> 

               <div class="row">
                    <div class="col-sm-6 col-md-5">
                        <label  style="font-size: 12px;"><i class="fa fa-clock-o"></i> Durée estimée </label><br>
                        <input type="number" name="duration" min="1" max="120" step="1" data-relationship_id="{{rc.id}}" id="duration{{rc.id}}"  data-type ="2" data-custom=0  value="{{ rc.duration }}" class="details_relation" /> min.
                    </div>
                    {% if rc.exercise.supportfile.is_ggbfile %}
                    <div class="col-sm-6 col-md-7">
                        <label  style="font-size: 12px;"><i class="fa fa-save"></i> Situations </label><br>
                        <label  style="font-size: 10px;">
                        <input type="number" name="situation" data-relationship_id="{{rc.id}}" id="situation{{rc.id}}" min="1" max="10" step="1"  data-type ="2" data-custom=0  value="{{ rc.situation  }}" class="details_relation" /> Nbre mini requis</label><br>

                        {% if parcours.is_evaluation %}  
                        <label  style="font-size: 12px;">Tentatives</label><br>
                        <input type="number" name="maxexo" min="1" max="10" step="1" data-relationship_id="{{rc.id}}" id="maxexo{{rc.id}}"   data-type ="2" data-custom=0  value="{{ rc.maxexo  }}" class="maxexo" />
 
  
                        <span class="helper_tip"> <label  style="font-size: 10px;"> Nbre maxi </label><i class="fa fa-question-circle"></i>
                            <div class="helper_tip_text red" >Ce nombre détermine le nombre maximum de fois que chaque exercice peut être fait. <br/> Laisser -1 pour ne pas définir le nombre d'essai.</div>
                        </span>
                        {% endif %}   

                    </div>
                    {% else %}
                    <div class="col-sm-6 col-md-6">
                        <label  style="font-size: 12px;">Nouvelle consigne </label><br>
                        <textarea style="font-size: 10px;width:110px" rows="3" name="situation" data-relationship_id="{{rc.id}}" id="situation{{rc.id}}" data-custom=0    data-type ="2"  class="details_relation form-control">{% if rc.instruction %}{{ rc.instruction|safe|truncatechars_html:45  }}{% endif %}</textarea>
                    </div>
                    {% endif %}
                </div> 
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <span class="select_details_close btn btn-xs btn-primary" data-relationship_id="{{rc.id}}">Valider</span>
                    </div>
                </div> 
          </div>
           <!--  
          =============================================================================================================
          =============================================================================================================
              Pop up de partage d'un exercice
          =============================================================================================================
          =============================================================================================================-->
          <div id="share{{ rc.id }}" class="card-dateur no_visu_on_load"  > 
              <div class="row">
                    <div class="col-sm-12 col-md-12   title">  
                      <span href="#card{{rc.id}}" class="select_share_close" data-relationship_id="{{rc.id}}"><i class="fa fa-times pull-right"></i></span>           
                         Redirections & Liens
                    </div>
               </div> 
              <hr style="padding:0px; margin:10px 0px"/><br>
                {% if rc.exercise.supportfile.is_ggbfile %}
                <a href="{% url 'show_this_exercise' rc.exercise.id %}" target="_blank" style="font-size:14px"><i class="fa fa-share-square fa-fw"></i> Vers l'exercice <i class="fa fa-barcode"></i> {{ rc.exercise.supportfile.code }}

                </a>
                {% else %}
                <a href="{% url 'show_write_exercise' rc.id %}" target="_blank" style="font-size:14px"><i class="fa fa-share-square fa-fw"></i> Vers l'exercice <i class="fa fa-barcode"></i> {{ rc.exercise.supportfile.code }}</a>
                {% endif %}
                <br><br>                
                <a href="#card{{rc.id}}" class="copy" 
                    data-custom=0 data-exercise_id="{{ rc.exercise.id}}" 
                    data-relationship_id="{{ rc.id}}"  data-parcours_id="{{ rc.parcours.id}}" 
                    style="font-size:14px">
                    <i  class="fa fa-clipboard fa-fw"></i> Copier pour coller dans une autre page
                </a> <br><br>   
                <a  href="#card{{rc.id}}" class="attribute_to_parcours"  
                    data-toggle='modal' data-target='#change_parcours' 
                    data-custom=0 data-parcours_id="{{ rc.parcours.id}}" 
                    data-exercise_id="{{ rc.id}}" style="font-size:14px">
                    <i  class="fa fa-random fa-fw"></i> Déplacer dans un autre parcours
                </a>
          </div>
           <!--  
          =============================================================================================================
          =============================================================================================================
              Pop up des compétences d'un exercice
          =============================================================================================================
          =============================================================================================================-->
          <div id="skill{{ rc.id }}" class="card-skill no_visu_on_load"> 

        
              <div class="row">
                    <div class="col-sm-12 col-md-12 title"><span   class="select_skill_close pull-right" data-relationship_id="{{rc.id}}"><i class="fa fa-times"></i></span>         
                        Compétences visées  
                    </div>
               </div> 
            <hr style="padding:0px; margin:10px 0px"/><br>
                {% for skill in rc.parcours.subject.skill.all %}  
                      <label style="font-size:10px">
                      <input type="checkbox" name="skills" data-relationship_id="{{rc.id}}" value="{{skill.id}}" class="skill_selector" {% if skill in rc.skills.all %} checked  {% endif %}  />
                      {{ skill }}
                      </label>{% if not forloop.last %}<br>{% endif %}
                {% empty %}
                  <div class="alert alert-danger">Vous devez sélectionner un enseignement pour ce parcours. 
                      {% if group %}<a href="{% url 'update_parcours' rc.parcours.id group_id  %}">Cliquez ici</a>{% endif %}
                  </div>
                {% endfor %}
          </div>
           <!--  
          =============================================================================================================
          =============================================================================================================
              Pop up des notes
          =============================================================================================================
          =============================================================================================================-->
          {% if not rc.exercise.supportfile.is_ggbfile %}
          <div id="select_note{{ rc.id }}"  class="card-dateur no_visu_on_load"  >  
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">
                    <span href="#card{{rc.id}}" class="select_note_close pull-right" data-relationship_id="{{rc.id}}"><i class="fa fa-times"></i></span>               
                        Notes 
                    </div>
               </div> 
              <hr style="padding:0px; margin:10px 0px"/> 

               <div class="row">
                    <div class="col-sm-6 col-md-7">
                        <label  style="font-size: 14px;">Sur ? </label>
                    </div>
                    <div class="col-sm-6 col-md-5">
                        <input type="number" step=0.5 min=0 name="mark" data-relationship_id="{{rc.id}}" id="mark{{rc.id}}" value="{% if  rc.is_mark %}{{ rc.mark }}{% endif %}" class="details_notes form-control" />  
                    </div>
                </div>
 
               <div class="row {% if not rc.is_mark %}is_marked{% endif %}" id = "is_marked{{rc.id}}" >
                    <div class="col-sm-6 col-md-7">
                        <label  style="font-size: 14px;">Supprimer la note ? </label>
                    </div>
                    <div class="col-sm-6 col-md-5">
                        <input type="checkbox" class="no_marker"    data-relationship_id="{{rc.id}}"    />  
                    </div>
                </div> 
 

                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <span class="select_notes_close btn btn-xs btn-primary" data-relationship_id="{{rc.id}}">Valider</span>
                    </div>
                </div> 
          </div>
          {% endif %}
           <!-- ######################################################################################################## 
          ############################################################################################################## 
          ##############################################################################################################
              Image de la card
          ##############################################################################################################
          ##############################################################################################################-->
          <a href="#card{{rc.id}}" class="detail_parcours"  data-exercise_id="{{ rc.exercise.id }}" 
              title="{% if rc.exercise.supportfile.title %}{{ rc.exercise.supportfile.title|cleanhtml|safe }}{% else %}{{ rc.exercise.supportfile.annoncement|cleanhtml|safe }}{% endif %}"
             data-num_exo="{% if not rc.is_publish %}{{ nb_exo_only|index:forloop.counter0 }}{% else %}{{ nb_exo_visible|index:forloop.counter0 }}{% endif %}" data-parcours_id="{{ parcours.id }}" data-custom=0 > 

               <img src="{{ rc.exercise.supportfile.imagefile.url }}"  class="image_parcours_order" loading="lazy" >   
          </a> 

           <!-- ######################################################################################################## 
          ############################################################################################################## 
          ##############################################################################################################
              Barre d'outil de la card
          ##############################################################################################################
          ##############################################################################################################-->

        <div class="card-text" style="background-color:{{ parcours.color }}; text-align:center;color:{{ parcours.color|contrast_color }}">
            <!-- Appel de la fenetre remédiation 
                  Appel ajax vers la modale qui est dans la page dashboard : id="remediation"
            -->
            {% if parcours.zoom %}
            <a class="helper_tip" style="color:{{ parcours.color|contrast_color }}">
                <i class="fa fa-search-plus"></i>
                <span class="helper_tip_card_flex" style="font-size:40px;color:{{ parcours.color }}">
                  {% if not rc.is_publish %}<span style="color:#F5F5F5;">{{ nb_exo_only|index:forloop.counter0 }}.</span>{% else %}{{ nb_exo_visible|index:forloop.counter0 }}.{% endif %}<br>
                  <img src="{{ rc.exercise.supportfile.imagefile.url }}" width="500px" loading="lazy" />
                </span>
            </a>
            {% endif %}

            <span style="font-size:9px;color:{{ parcours.color|contrast_color }}" id="response{{rc.id}}" >{{  rc.relationship_remediation.all|length }}</span>


            {% if sacado_asso %}
            <span class="horizontalmargin5">
                <span style="cursor:pointer;color:{{ parcours.color|contrast_color }}" data-target="#remediation" data-relationship_id="{{ rc.id }}"  data-toggle='modal' class="remediation" title="Ajouter une vidéo, un fichier" >
                        <i class="fa fa-paperclip"></i>
                </span>
            </span>
            {% else %}
            <span class="horizontalmargin5">
                <span style="cursor:not-allowed;color:{{ parcours.color|contrast_color }}"  class="remediation" title="Version établissement requise." >
                        <i class="fa fa-paperclip"></i>
                </span>
            </span>
            {% endif %}




            <span class="horizontalmargin5"><a href="{% url 'create_mastering' rc.id  %}" title="Parcours de maîtrise à partir de cet exercice" style="font-size:14px;color:{{ parcours.color|contrast_color }}"><i class="fa fa-sitemap"></i></a></span> 

            {% if sacado_asso %}
            <!-- Appel des compétences -->
            <span class="select_skills horizontalmargin5"  data-relationship_id="{{ rc.id }}" id="skill{{rc.id}}" title="Ajouter des compétences" ><i class="fa fa-cogs"></i> </span>
            {% else %}
            <span class="select_skills horizontalmargin5" style="cursor:not-allowed"  title="Version établissement requise."  ><i class="fa fa-cogs"></i> </span>
            {% endif %}


 

            {% if rc.exercise.supportfile.is_ggbfile %}
            <!-- Appel des situations et durée -->
            <span class="select_details horizontalmargin5"  data-relationship_id="{{ rc.id }}" id="clock{{rc.id}}"  title="Modifier le temps"><!-- l'id permet de modifier après ajax le temps -->
                <!-- <i class="fa fa-clock-o"></i> --><span style="font-size:10px">{{ rc.duration }} min.</span> 
            </span>
            <!-- Appel des situations -->
            <span class="select_details horizontalmargin5"  data-relationship_id="{{ rc.id }}" id="save{{rc.id}}" title="Modifier le nombre de situations"><!-- l'id permet de modifier après ajax le nombre de situation -->
                <i class="fa fa-save"></i> {{ rc.situation}}  
            </span>
            {% else %}
            <!-- Appel des durées -->
            <span class="select_details horizontalmargin5"  data-relationship_id="{{ rc.id }}" id="clock{{rc.id}}"  title="Modifier le temps"><!-- l'id permet de modifier après ajax le temps -->
                 <span style="font-size:10px">{{ rc.duration }} min.</span> 
            </span>
            <!-- Appel des situations -->
            <span class="select_details horizontalmargin5"  data-relationship_id="{{ rc.id }}" id="save{{rc.id}}" title="Modifier la consigne"><!-- l'id permet de modifier après ajax le nombre de situation -->
                <i class="fa fa-pencil-square" style="font-size:15px"></i> 
            </span>
            <!-- Appel des notes -->
            <span class="select_note"  data-relationship_id="{{ rc.id }}" id="marker{{rc.id}}"  title="Noter cet exercice"><!-- l'id permet de modifier après ajax le temps -->
                <span style="font-size:8px; font-weight: 800" class="no_new_mark" id="no_new_mark{{ rc.id }}">
                    $\frac{  n  }{  {% if rc.is_mark %} {{rc.mark}} {% else %}?{% endif  %}  }$
                </span>
                <span style="font-size:8px; font-weight: 800" class="new_mark" id="new_mark{{ rc.id }}">
 
                </span>
            </span>
            <!-- Appel des copies à corriger  -->
            <span class="select_details horizontalmargin5" style="width:40px">
                {% if rc.is_pending_correction %}              
                <a href="{% url 'correction_exercise'  rc.id 0 0 %}" title="Copies à corriger" style="font-weight:bold; font-size:16px;color:{{ parcours.color|contrast_color }}" ><i class="fa fa-cc text-warning"></i></a>  
                {% else %}
                <a href="{% url 'correction_exercise'  rc.id 0 0 %}" title="Voir les copies corrigées" style="font-size:16px;color:{{ parcours.color|contrast_color }}" ><i class="fa fa-copyright"></i></a> 
                {% endif %}
            </span>
            {% endif %}
            <!-- Appel de partage  -->
            <span  class="sharered horizontalmargin5" data-relationship_id="{{ rc.id }}"  title="Accéder à cet exercice" style="cursor:pointer">
               <i class="fa fa-share-square"></i>
            </span>                                   

             <a href = "#" data-toggle = 'modal'
                data-target = '#reset_exercice'  
                class = "reset horizontalmargin5" 
                data-nb = "{% if not rc.is_publish %}{{ nb_exo_only|index:forloop.counter0 }}{% else %}{{ nb_exo_visible|index:forloop.counter0 }}{% endif %}" 
                data-relationship_id = "{{ rc.id }}"
                data-group_id = "{{ group.id }}"   
                data-custom = 0    title = "Effacer les résultats de cet exercice" 
                style = "font-size:14px;color:{{ parcours.color|contrast_color }}">

                <i class="fa fa-refresh"></i> 
            </a>

            <a href = "#" data-toggle = 'modal'
                data-target = '#individualisation_exercice'  
                class = "individualiser horizontalmargin5" 
                data-nb = "{% if not rc.is_publish %}{{ nb_exo_only|index:forloop.counter0 }}{% else %}{{ nb_exo_visible|index:forloop.counter0 }}{% endif %}" 
                data-relationship_id = "{{ rc.id }}"
                data-group_id = "{{ group.id }}"   
                data-custom = 0  title = "Individualiser cet exercice" 
                style = "font-size:14px;color:{{ parcours.color|contrast_color }}">

                <i class="fa fa-users"></i> 
            </a>



            <!-- Suppression de l'exercice dans ce parcours  -->
            <a href="{% url 'delete_relationship' rc.id %}" class="horizontalmargin5"   title="Supprimer cet exercice de cette séquence" style="font-size:14px;color:{{ parcours.color|contrast_color }}" onclick="return TestDelete('cet exercice de cette séquence')"  >
                <i class="fa fa-trash"></i> 
            </a>

            {% if not rc.is_publish and not rc.start %}<br>
            <span href="#card{{rc.id}}" title="Date de publication" class="select_publish white horizontalmargin5" id="select_publish{{rc.id}}" data-relationship_id="{{rc.id}}" data-statut="{{rc.is_publish }}" style="cursor:pointer">
                <i class="fa fa-calendar-check"> </i> <span style="font-size:12px">Date de publication ?</span>  
            </span>
            {% endif %}
        </div>
    </div>
    <!-- Partie sur laquelle est posée l'image  -->   
</div> 


{% elif rc.type_id == 1 %}

  {% with rc.type_of_document as tod %}
  <div class="card_freeze" style="{% if not tod.is_publish %}background-color: #F5F5F5{% else %}background:#FFF{% endif %}" id="card{{tod.id}}">
      <!-- Entete de la card  -->
      <div class="card-body" style="height:37px;">
                      <input type="hidden" value="{{ rc.id }}" name="relationship_id_sequence" class="relationship_id_sequence" /><!--  sert à classer les thèmes  -->
            <a href="" style="cursor:move;" class="move_inside" style="color:{{ parcours.color }}"> 
            {% if not tod.is_publish %}<span style="color:#F5F5F5">{{ nb_exo_only|index:forloop.counter0 }}.</span>{% else %}{{ nb_exo_visible|index:forloop.counter0 }}.{% endif %}
            </a>
                         
            <div class="card-score">
   
                {%  get_percent_student_done_parcours_exercice_group   rc   parcours   group  as    data %}
   
                <div class="progress">
                  <div class="progress-bar bg-success" role="progressbar" style="width: {{ data.percent }}%;{% if not tod.is_publish %}color: #F5F5F5{% endif %};background-color: {{tod.parcours.color }};" aria-valuenow="{{ data.percent }}" aria-valuemin="0" aria-valuemax="100">{{ data.percent }}%</div>
                </div>
            </div>
            <span class="label_progress_bar" style="color:{{ parcours.color }}">{{ data.nb_done }}/{{ data.nb }}</span> 
            {% if tod.calculator %}
              <img src="{% static 'img/calculator.png' %}" class="pull-right" width="35px" loading="lazy" />
            {% else %}
              <img src="{% static 'img/no_calculator.png' %}" class="pull-right" width="35px" loading="lazy" />
            {% endif  %}
      </div>   
      <!-- Fin Entete de la card  -->

      <!-- Partie sur laquelle est posée l'image  -->                  
      <div class="card-image">
            <div style="position: absolute; left : 30px; top:41px;" id="annoncement{{tod.id}}"   >   
                <span class="helper_tip btn btn-default">
                        Consigne {% if tod.text_cor or  tod.video_cor or  tod.file_cor %}+ correction 
                                    <small><i class="fa fa-{% if tod.is_publish_cor %}eye{% else %}eye-slash{% endif %}"></i></small>
                                 {% endif %}
                  <div class="helper_tip_text_right">{{tod.instruction|safe|truncatechars_html:45}} </div> 
                </span>
            </div>

            {% get_is_lock tod today as is_block %} 
            {% if is_block  %}
                <a href="{%  url 'parcours_update_custom_exercise' tod.id  parcours.id %}">
                    <div class="alert alert-danger" style="position: absolute; z-index:9; top:100px;font-size:12px;border-radius: 0px 4px 4px  0px;"> 
                        <i class="fa fa-lock"></i> <span class="hidden_lock"> {{ tod.lock|date:"d-m-Y à H:i" }}</span>
                    </div>
                </a>
            {% endif %}

            <!-- Exercice dissocié  -->
            {% if  group  %}  
            {% get_students_from_group_and_rc tod group as data_rc %}

            {% if  data_rc.nb == only_real_student.count  %}  
            <div  style="position: absolute; right : 0px; top:60px;" title="Cet exercice est indiviualisé à certains élèves. Cliquez sur l'icone dans la barre d'outil pour modifier."  >   
                <a href="#customcard{{tod.id}}" class="detail_parcours btn btn-warning" data-custom=0
                   data-exercise_id="{{ tod.id }}"  data-num_exo="{% if not tod.is_publish %}{{ nb_exo_only|index:forloop.counter0 }}{% else %}{{ nb_exo_visible|index:forloop.counter0 }}{% endif %}" data-parcours_id="{{ parcours.id }}">
                  <i class="fa fa-users"></i><span id="nb_indiv_id_student{{tod.id }}">{{ data_rc.nb }} </span> 
                </a>
            </div>
            {% endif %}
   
            {% endif %}




            <!-- Pour ces deux actions, on ne modifie pas relationship_id en customexercise_id pour utiliser la même fonction Jquery dans dashboard.js  -->
            <!-- Publication  -->
            <div href="#customcard{{tod.id}}" class="action_content {% if  tod.is_publish %}btn btn-success{% else %}btn btn-danger{% endif %}"  style="position: absolute; right : 0px; top:90px;" id="publisher{{tod.id}}"  data-relationship_id="{{tod.id}}" data-statut="{{tod.is_publish }}" data-custom="0" title="Publier l'exercice" >   
                {% if  tod.is_publish %}Publié{% elif tod.start %}{{ tod.start|date:"d N Y" }}{% else %}Dépublié{% endif %}
            </div>

            <!-- Tache  -->
            <div href="#customcard{{tod.id}}" class="btn btn-{% if  tod.date_limit %}success{% else %}default{% endif %} custom_select_task"  style="position: absolute; right : 0px; top:120px;" id="pub_task{{tod.id}}" data-relationship_id="{{tod.id}}" data-statut="{{tod.is_task }}" data-custom="0"  title="Proposer une tâche pour le" >   
                <span id="loading{{ tod.id }}"></span>{% if  tod.date_limit %}{{tod.date_limit|date:"d N Y" }}{% else %}Tâche ?{% endif %}
            </div>
   

            <!--  
            =============================================================================================================
            =============================================================================================================
                  Pop up de la date de la tache d'un exercice  
            =============================================================================================================
            =============================================================================================================-->

            <!-- Pop up de la date de la tache d'un exercice  -->
            <div id="custom_detail_dateur{{tod.id}}" class="card-dateur no_visu_on_load"  > 
                <div class="row">
                      <div class="col-sm-12 col-md-12 title">     
                          <span href="#customcard{{tod.id}}" class="custom_select_task_close pull-right" data-customexercise_id="{{tod.id}}"><i class="fa fa-times"></i></span>  
                           Programmation de tâche  
                      </div>
                 </div> 
                <div class="row">
                    <div class="col-sm-12 col-md-12">              
                      <hr style="padding:0px; margin:10px 0px"/> 
                      <label  style="font-size: 10px;">Date limite de rendu ?</label><br>
                      <input type="type" name="dateur" data-relationship_id="{{tod.id}}" data-type ="1" data-custom ="1" value='{{ tod.date_limit|date:"Y-m-d" }}' class="datetimepicker dateur pull-right" />
                
                    </div>
                </div> 
                <hr style="padding:0px; margin:10px 0px"/> 
                  <div class="row">
                      <div class="col-sm-12 col-md-12">
                          <span class="custom_select_task_close btn btn-xs btn-primary" data-customexercise_id="{{tod.id}}">Valider</span>
                      </div>
                  </div> 
            </div>

            <!-- Pop up de la date de publication d'un exercice  -->
            <div id="custom_detail_pub{{tod.id}}" class="card-dateur no_visu_on_load"  >
                <div class="row">
                      <div class="col-sm-12 col-md-12 title">     
                          <span href="#card{{tod.id}}" class="custom_select_publish_close pull-right" data-customexercise_id="{{tod.id}}"><i class="fa fa-times"></i></span>  
                           Date de publication
                      </div>  
                 </div> 
                <hr style="padding:0px; margin:10px 0px"/> 
                <div class="row">
                    <div class="col-sm-12 col-md-12">      
                    <label  style="font-size: 12px;">Date de publication ?</label><br>
                                                        <!-- on conserve  relationship_id pour réutiliser la fonction JS-->
                    <input type="type" name="start" data-relationship_id="{{tod.id}}" data-type ="0" data-custom ="1" value='{{ tod.date_limit|date:"Y-m-d" }}' class="datetimepicker dateur pull-right" />
                    </div>
                </div>
                <hr style="padding:0px; margin:10px 0px"/>                 
                  <div class="row">
                      <div class="col-sm-12 col-md-12">
                          <span class="custom_select_publish_close btn btn-xs btn-primary" data-customexercise_id="{{tod.id}}">Valider</span>
                      </div>
                  </div>
   
            </div>


            <!-- Pop up de la durée et du nombre de situation d'un exercice  -->
            <div id="custom_details{{tod.id}}" class="card-dateur no_visu_on_load"  > 
                <div class="row">
                      <div class="col-sm-12 col-md-12 title">
                      <span href="#customcard{{tod.id}}" class="custom_select_details_close pull-right" data-customexercise_id="{{tod.id}}"><i class="fa fa-times"></i></span>               
                          Contexte 
                      </div>
                 </div> 
                <hr style="padding:0px; margin:10px 0px"/> 

                 <div class="row">
                      <div class="col-sm-6 col-md-6">
                          <label  style="font-size: 12px;"><i class="fa fa-clock-o"></i> Durée estimée </label><br>
                          <input type="type" name="duration" data-customexercise_id="{{tod.id}}" id="duration{{tod.id}}"  data-type ="2"  value="{{ tod.duration }}" class="custom_details_exercise" /> min.
                      </div>
                  </div> 
                <hr style="padding:0px; margin:10px 0px"/>  
                  <div class="row">
                      <div class="col-sm-12 col-md-12">
                          <span class="select_details_close btn btn-xs btn-primary" data-customexercise_id="{{tod.id}}">Valider</span>
                      </div>
                  </div> 
            </div>

            <!-- Pop up de partage d'un exercice  -->
            <div id="custom_share{{ tod.id }}" class="card-dateur no_visu_on_load"  > 
                <div class="row">
                      <div class="col-sm-12 col-md-12   title">  
                        <span href="#customcard{{tod.id}}" class="custom_select_share_close" data-customexercise_id="{{tod.id}}"><i class="fa fa-times pull-right"></i></span>           
                           Redirections & Liens
                      </div>
                 </div> 
                <hr style="padding:0px; margin:10px 0px"/><br> 
                  <a href="{%  url 'show_custom_exercise'  tod.id  parcours.id %}" target="_blank" style="font-size:14px"><i class="fa fa-share-square fa-fw"></i> Vers l'exercice <i class="fa fa-barcode"></i> {{ tod.code }}</a>
                  <br><br>                
                  <a href="#customcard{{tod.id}}" class="copy" data-exercise_id="{{ tod.id}}" data-custom=1 data-parcours_id="{{ parcours.id}}" style="font-size:14px"><i class="fa fa-clipboard fa-fw"></i> Copier pour coller dans une autre page</a> 
                  <br><br>   
                  <a href="#customcard{{tod.id}}" class="attribute_to_parcours"  data-toggle='modal' data-target='#change_parcours'  data-custom=1 data-parcours_id="{{ parcours.id}}"  data-exercise_id="{{ tod.id}}" style="font-size:14px"><i  class="fa fa-random fa-fw"></i> Déplacer dans un autre parcours</a>
            </div>

            <!-- Pop up des compétences d'un exercice  -->
            <div id="custom_skill{{ tod.id }}" class="card-skill no_visu_on_load"> Compétences visées<br>
                <span   class="select_skill_close pull-right" data-customexercise_id="{{tod.id}}"><i class="fa fa-times"></i></span>
                  {% for skill in skills %}
                        <label style="font-size:10px">
                        <input type="checkbox" name="skills" data-customexercise_id="{{tod.id}}" value="{{skill.id}}" class="skill_selector" {% if skill in tod.skills.all %} checked {% endif %}  />
                        {{ skill }}
                        </label>{% if not forloop.last %}<br>{% endif %}
                  {% endfor %}
            </div>

   
            <!--  Image de la card  -->
            <a href="#customcard{{tod.id}}" class="detail_parcours"  data-exercise_id="{{ tod.id }}"  
               data-num_exo="{{ nb_exo_only|index:forloop.counter0 }}" data-parcours_id="{{ parcours.id }}" data-custom=1>
               
                 <img {% if tod.imagefile %} src="{{ tod.imagefile.url }}" {% elif tod.is_python %}  src="{% static 'img/python.jpg' %}" 
                         {% else %}  src="{% static 'img/custom_exercise.jpg' %}" {% endif %} class="image_parcours_order" loading="lazy"  >
              
            </a> 
          <!--  Barre d'outil de la customcard  -->
          <div class="card-text" style="background-color:{{ parcours.color }}; text-align:center;color:{{ parcours.color|contrast_color }}">

              {% if parcours.zoom %}
               <a class="helper_tip white">
                  <i class="fa fa-search-plus"></i>
                  <span class="helper_tip_card_flex" style="font-size:40px;color:{{ parcours.color }}">
                    {% if not tod.is_publish %}<span style="color:#F5F5F5;">{{ nb_exo_only|index:forloop.counter0 }}.</span>{% else %}{{ nb_exo_visible|index:forloop.counter0 }}.{% endif %}<br>
                    <img {% if tod.imagefile %} src="{{ tod.imagefile.url }}"
                         {% elif tod.is_python %}  src="{% static 'img/python.jpg' %}" 
                         {% else %}  src="{% static 'img/custom_exercise.jpg' %}" {% endif %} width="500px" loading="lazy" />
                  </span>
              </a>
              {% endif %}
   
              <span style="font-size:9px">{{  tod.customexercise_remediation.all|length }}</span>


              {% if sacado_asso %}
              <span class="horizontalmargin5">
                  <span style="cursor:pointer" data-target="#remediation" data-customexercise_id="{{ tod.id }}"  data-parcours_id="{{ parcours.id }}"  data-toggle='modal' class="white remediationCustom" title="Ajouter une vidéo, un fichier" >
                          <i class="fa fa-paperclip"></i>
                  </span>
              </span> 
              {% else %}
              <span class="horizontalmargin5">
                  <span style="cursor:not-allowed;"  class="white remediationCustom" title="Version établissement requise." >
                          <i class="fa fa-paperclip"></i>
                  </span>
              </span> 
              {% endif %}


              <span class="horizontalmargin5"><a href="#" style="font-size:14px;color:{{ parcours.color|contrast_color }}" class="copy_link" title="Code de l'exercice" data-code="{{ tod.code}}"><i class="fa fa-barcode"></i></a></span> 
              {% comment %}
              <!-- Appel des parcours de maitrise -->
              <span class="horizontalmargin5"><a href="{% url 'create_mastering_custom' tod.id parcours.id %}" title="Parcours de maîtrise à partir de cet exercice" style="font-size:14px;color:{{ parcours.color|contrast_color }}"><i class="fa fa-sitemap"></i></a></span> 
              {% endcomment %}
              <!-- Appel des situations et durée -->
              <span class="custom_select_details horizontalmargin5"  data-customexercise_id="{{ tod.id }}" id="clock{{tod.id}}"  title="Modifier le temps"><!-- l'id permet de modifier après ajax le temps -->
                    {{ tod.duration }} min. 
              </span>
              <!-- Appel des situations -->
               
              <!-- Appel de partage  -->
              <span  class="custom_sharer horizontalmargin5" data-customexercise_id="{{ tod.id }}"   title="Accéder à cet exercice" style="cursor:pointer">
                 <i class="fa fa-share-square"></i>
              </span>                                   
   
               <a href = "#" data-toggle = 'modal'
                  data-target = '#individualisation_exercice'  
                  class = "individualiser horizontalmargin5" 
                  data-nb = "{% if not tod.is_publish %}{{ nb_exo_only|index:forloop.counter0 }}{% else %}{{ nb_exo_visible|index:forloop.counter0 }}{% endif %}" 
                  data-relationship_id = "{{ tod.id }}"
                  data-group_id = "{{ group.id }}"   
                  data-custom = 1  title = "Individualiser cet exercice" 
                  style = "font-size:14px;color:{{ parcours.color|contrast_color }}">

                  <i class="fa fa-users"></i>
              </a>

   
              <span class="horizontalmargin5">
                  <a href="{%  url 'parcours_update_custom_exercise' tod.id  parcours.id %}" title="Modifier cet exercice" style="font-size:15px;color:{{ parcours.color|contrast_color }}" ><i class="fa fa-pencil-square-o"></i></a> 
              </span>

            <!-- Suppression de l'exercice dans ce parcours  -->
            <a href="{% url 'delete_relationship' rc.id %}" class="horizontalmargin5"   title="Supprimer cet exercice de cette séquence" style="font-size:14px;color:{{ parcours.color|contrast_color }}" onclick="return TestDelete('cet exercice de cette séquence')"  >
                <i class="fa fa-trash"></i> 
            </a>

              <span class="horizontalmargin5" style="width:40px">
                  {% if tod.is_pending_correction %}
                  <a href="{% url 'correction_exercise'  tod.id  parcours.id 0 %}" title="Copies à corriger" style="font-weight:bold; font-size:16px;color:{{ parcours.color|contrast_color }}" ><i class="fa fa-cc  text-warning"></i></a>  
                  {% else %}
                  <a href="{% url 'correction_exercise'  tod.id  parcours.id 0 %}" title="Voir les copies corrigées" style="position: relative; font-size:16px;color:{{ parcours.color|contrast_color }}" ><i class="fa fa-copyright"></i></a> 
                  {% endif %}
              </span>
              {% if not tod.is_publish and not tod.start %}<br>
              <span href="#customcard{{tod.id}}" title="Date de publication" class="custom_select_publish white horizontalmargin5" id="select_publish{{tod.id}}" data-customexercise_id="{{tod.id}}" data-statut="{{tod.is_publish }}" style="cursor:pointer">
                  <i class="fa fa-calendar-check"> </i> <span style="font-size:12px">Date de publication ?</span>  
              </span>
              {% endif %}
          </div>
      </div>
      <!-- Partie sur laquelle est posée l'image  -->   
  </div>

  {% endwith %}

{% else %}
<div  class="card_freeze_sequence" id="card{{rc.id}}">
    <!-- Entete de la card  -->
    <div class="card-body" style="height:37px;">
          <input type="hidden" value="{{ rc.id }}" name="relationship_id_sequence" class="relationship_id_sequence" /><!--  sert à classer les thèmes  -->
          <a href="" style="cursor:move;" class="move_inside" style="color:{{ parcours.color }}"> 
         
          </a>
                       
          <div class="card-score" style="margin-left:10px;width:100%;font-size: 30px;color: #5d4391">
   
                    {% if rc.type_id == 2 %}  COURS   
                    {% elif rc.type_id == 3 %} QUIZ  
                    {% elif rc.type_id == 4 %} FLASHPACK   
                    {% elif rc.type_id == 5 %} BIBLIOTEX
                    {% endif %}


          </div>
    </div>   
    <!-- Fin Entete de la card  -->

    <!-- Partie sur laquelle est posée l'image  -->                  
    <div class="card-image">

          <div class="title_document_sequence">
              {{ rc.type_of_document.title }} 
          </div>

          <!-- Pour ces deux actions, on ne modifie pas relationship_id en customexercise_id pour utiliser la même fonction Jquery dans dashboard.js  -->
          <!-- Publication  -->
          <div href="#customcard{{rc.id}}" class="action_content {% if  rc.is_publish %}btn btn-success{% else %}btn btn-danger{% endif %}"  style="position: absolute; right : 0px; top:90px;" id="publisher{{rc.id}}"  data-relationship_id="{{rc.id}}" data-statut="{{rc.is_publish }}" data-custom="0" title="Publier l'exercice" >   
              {% if  rc.is_publish %}Publié{% elif rc.start %}{{ rc.start|date:"d N Y" }}{% else %}Dépublié{% endif %}
          </div>

          <!-- Tache  -->
          <div href="#customcard{{rc.id}}" class="btn btn-{% if  rc.date_limit %}success{% else %}default{% endif %} custom_select_task"  style="position: absolute; right : 0px; top:120px;" id="pub_task{{rc.id}}" data-relationship_id="{{rc.id}}" data-statut="{{rc.is_task }}" data-custom="0"  title="Proposer une tâche pour le" >   
              <span id="loading{{ rc.id }}"></span>{% if  rc.date_limit %}{{rc.date_limit|date:"d N Y" }}{% else %}Tâche ?{% endif %}
          </div>
 

          <!--  
          =============================================================================================================
          =============================================================================================================
                Pop up de la date de la tache d'un exercice  
          =============================================================================================================
          =============================================================================================================-->

          <!-- Pop up de la date de la tache d'un exercice  -->
          <div id="custom_detail_dateur{{rc.id}}" class="card-dateur no_visu_on_load"  > 
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">     
                        <span href="#customcard{{rc.id}}" class="custom_select_task_close pull-right" data-customexercise_id="{{rc.id}}"><i class="fa fa-times"></i></span>  
                         Programmation de tâche  
                    </div>
               </div> 
              <div class="row">
                  <div class="col-sm-12 col-md-12">              
                    <hr style="padding:0px; margin:10px 0px"/> 
                    <label  style="font-size: 10px;">Date limite de rendu ?</label><br>
                    <input type="type" name="dateur" data-relationship_id="{{rc.id}}" data-type ="1" data-custom ="1" value='{{ rc.date_limit|date:"Y-m-d" }}' class="datetimepicker dateur pull-right" />
              
                  </div>
              </div> 
              <hr style="padding:0px; margin:10px 0px"/> 
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <span class="custom_select_task_close btn btn-xs btn-primary" data-customexercise_id="{{rc.id}}">Valider</span>
                    </div>
                </div> 
          </div>

          <!-- Pop up de la date de publication d'un exercice  -->
          <div id="custom_detail_pub{{rc.id}}" class="card-dateur no_visu_on_load"  >
              <div class="row">
                    <div class="col-sm-12 col-md-12 title">     
                        <span href="#card{{rc.id}}" class="custom_select_publish_close pull-right" data-customexercise_id="{{rc.id}}"><i class="fa fa-times"></i></span>  
                         Date de publication
                    </div>  
               </div> 
              <hr style="padding:0px; margin:10px 0px"/> 
              <div class="row">
                  <div class="col-sm-12 col-md-12">      
                  <label  style="font-size: 12px;">Date de publication ?</label><br>
                                                      <!-- on conserve  relationship_id pour réutiliser la fonction JS-->
                  <input type="type" name="start" data-relationship_id="{{rc.id}}" data-type ="0" data-custom ="1" value='{{ rc.date_limit|date:"Y-m-d" }}' class="datetimepicker dateur pull-right" />
                  </div>
              </div>
              <hr style="padding:0px; margin:10px 0px"/>                 
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <span class="custom_select_publish_close btn btn-xs btn-primary" data-customexercise_id="{{rc.id}}">Valider</span>
                    </div>
                </div>
 
          </div>


 

        <!--  Barre d'outil de la customcard  -->
        <div class="card-text" style="background-color:{{ parcours.color }}; text-align:center;color:{{ parcours.color|contrast_color }}">


            <span class="custom_select_details horizontalmargin5"  ><!-- l'id permet de modifier après ajax le temps -->

                    {% if rc.type_id == 3 %}  {{ rc.type_of_document.questions.count }} questions
                    {% elif rc.type_id == 4 %}  {{ rc.type_of_document.flashcards.count }} flashcards
                    {% elif rc.type_id == 5 %}  {{ rc.type_of_document.relationtexs.count }} exercices
                    {% endif %}


            </span>
            <!-- Appel des situations et durée -->
            <span class="custom_select_details horizontalmargin5"  data-customexercise_id="{{ rc.id }}" id="clock{{rc.id}}"  title="Modifier le temps"><!-- l'id permet de modifier après ajax le temps -->

                    {% if rc.type_id == 2 %}  {{ rc.type_of_document.duration }} min. 
                    {% elif rc.type_id == 3 %}  {{ rc.type_of_document.duration|time_done }}  
                    {% endif %}


            </span>
            <!-- Appel des situations -->
             
            <!-- Appel de partage  -->
 
                <a  class="white"
                    {% if rc.type_id == 1 %}  href="{%  url 'show_custom_sequence'  rc.type_of_document.id %}"
                    {% elif rc.type_id == 2 %}  href="{%  url 'show_one_course'  rc.type_of_document.id   %}"
                    {% elif rc.type_id == 3 %}  href="{%  url 'show_quizz_shared'  rc.type_of_document.id   %}"
                    {% elif rc.type_id == 4 %}  href="{%  url 'show_flashpack'  rc.type_of_document.id    %}"
                    {% elif rc.type_id == 5 %}  href="{%  url 'show_bibliotex'  rc.type_of_document.id %}"
                    {% endif %}
                    target="_blank" style="font-size:14px"><i class="fa fa-share-square fa-fw"></i>
                </a>


                                     
 
             <a href = "#" data-toggle = 'modal'  
                data-target = '#individualisation_exercice'  
                class = "individualiser_document horizontalmargin5 white" 
                data-nb = "{% if not rc.is_publish %}{{ nb_exo_only|index:forloop.counter0 }}{% else %}{{ nb_exo_visible|index:forloop.counter0 }}{% endif %}" 
                data-relationship_id = "{{ rc.id }}"
                data-group_id = "{{ group.id }}"   
                title = "Individualiser ce document" 
                style = "font-size:14px;color:{{ parcours.color|contrast_color }}">

                {{ rc.students.count  }} <i class="fa fa-users"></i>
            </a>

 



            <!-- Suppression de l'exercice dans ce parcours  -->
            <a href="{% url 'delete_relationship' rc.id %}" class="horizontalmargin5"   title="Supprimer cet exercice de ce parcours" style="font-size:14px;color:{{ parcours.color|contrast_color }}" onclick="return TestDelete('ce document de cette séquence')"  >
                <i class="fa fa-trash"></i> 
            </a>

        </div>
    </div>
    <!-- Partie sur laquelle est posée l'image  -->   
</div> 
{% endif %}






